# AI 絵画指導アプリ 要件定義書

## はじめに

AI 絵画指導アプリは、初心者向けのデジタル絵画学習プラットフォームです。ユーザーがアップロードした写真を基に、AI が段階的な描画手順を生成し、各ステップごとに参考画像とテキスト指示を提供する教育アプリケーションです。本アプリは、従来の絵画教室での対面指導をデジタル化し、いつでもどこでも質の高い絵画指導を受けられる環境を提供します。

## 要件

### 要件 1: 写真アップロード機能

**ユーザーストーリー:** 絵画初心者として、描きたい写真をアップロードできるようにしたい。そうすることで、自分の好きな題材で絵画学習を始められる。

#### 受入基準

1. WHEN ユーザーが写真選択ボタンをクリック THEN システムは ファイル選択ダイアログを表示する
2. WHEN ユーザーが対応形式の画像ファイル（JPEG、PNG、WebP）を選択 THEN システムは 画像をプレビュー表示する
3. WHEN ユーザーが 2MB 以上のファイルを選択 THEN システムは エラーメッセージを表示し、アップロードを拒否する
4. WHEN ユーザーが対応外形式のファイルを選択 THEN システムは 「対応していない形式です」というエラーメッセージを表示する
5. WHEN 画像アップロードが完了 THEN システムは 次のステップ（画材選択）に進むボタンを有効化する

### 要件 2: 画材選択機能

**ユーザーストーリー:** 絵画学習者として、自分が使いたい画材を選択できるようにしたい。そうすることで、実際に持っている画材に合わせた指導を受けられる。

#### 受入基準

1. WHEN ユーザーが画材選択画面を表示 THEN システムは デッサン、水彩画、色鉛筆、アクリル絵の具の選択肢を表示する
2. WHEN ユーザーが画材を選択 THEN システムは 選択した画材をハイライト表示する
3. WHEN ユーザーが画材を選択済み THEN システムは 「解析開始」ボタンを有効化する
4. WHEN ユーザーが「解析開始」ボタンをクリック THEN システムは AI 解析処理を開始し、ローディング画面を表示する

### 要件 3: AI 画像解析・難易度判定機能

**ユーザーストーリー:** 絵画初心者として、アップロードした画像の難易度を自動判定してもらいたい。そうすることで、自分のレベルに適した学習計画を立てられる。

#### 受入基準

1. WHEN システムが AI 解析を開始 THEN システムは Gemini API を使用して画像の複雑さを分析する
2. WHEN AI 解析が完了 THEN システムは 初級・中級・上級のいずれかの難易度を判定する
3. WHEN 難易度判定が完了 THEN システムは 判定結果と理由を画面に表示する
4. WHEN 解析結果画面を表示 THEN システムは 「手順を表示する」と「他の絵を選ぶ」ボタンを表示する
5. IF 解析処理が 30 秒以上かかる場合 THEN システムは タイムアウトエラーを表示し、再試行オプションを提供する

### 要件 4: 段階的手順生成機能

**ユーザーストーリー:** 絵画学習者として、選択した画材に応じた段階的な描画手順を取得したい。そうすることで、体系的に絵画技術を学習できる。

#### 受入基準

1. WHEN ユーザーが「手順を表示する」ボタンをクリック THEN システムは 選択した画材に応じた手順生成を開始する
2. WHEN 手順生成処理を実行 THEN システムは Gemini API を使用して 4-6 段階の描画手順を生成する
3. WHEN デッサンが選択されている場合 THEN システムは 下書き → 輪郭 → 陰影 → 仕上げの手順を生成する
4. WHEN 水彩画が選択されている場合 THEN システムは 下書き → 薄塗り → 中間色 → 濃い色 → 仕上げの手順を生成する
5. WHEN 手順生成が完了 THEN システムは 各段階の参考画像とテキスト指示を含む指導画面を表示する

### 要件 5: ステップバイステップ指導表示機能

**ユーザーストーリー:** 絵画学習者として、各描画段階で詳細な指示と参考画像を確認したい。そうすることで、迷うことなく描画を進められる。

#### 受入基準

1. WHEN 指導画面を表示 THEN システムは 現在のステップ番号と全体の進捗を表示する
2. WHEN 各ステップを表示 THEN システムは 参考画像、テキスト指示、描画のコツを同時に表示する
3. WHEN ユーザーが「次へ」ボタンをクリック THEN システムは 次のステップに進む
4. WHEN ユーザーが「戻る」ボタンをクリック THEN システムは 前のステップに戻る
5. WHEN 最初のステップを表示中 THEN システムは 「戻る」ボタンを無効化する
6. WHEN 最後のステップを表示中 THEN システムは 「次へ」ボタンを「完了」ボタンに変更する

### 要件 6: AI 画像生成機能（Gemini 2.5 Flash Image）

**ユーザーストーリー:** 絵画学習者として、アップロードした画像から段階的な描画ガイド画像を自動生成してもらいたい。そうすることで、各工程での目標を視覚的に理解できる。

#### 受入基準

1. WHEN システムが線画を生成 THEN システムは Gemini 2.5 Flash Image を使用して白背景に黒い線のみの線画を作成する（色・グレー・テクスチャ禁止）
2. WHEN システムがベタ塗り画像を生成 THEN システムは 8-10 色のポスタライズ＋選択画材の質感を弱めに反映した不透明 PNG を作成する
3. WHEN システムがハイライト画像を生成 THEN システムは 白ハイライトのみを含む透明 PNG ＋選択画材の質感を反映した画像を作成する
4. WHEN システムが色塗り見本を生成 THEN システムは 選択画材の質感を強めに反映した完成見本を作成する
5. WHEN 画材が選択されている場合 THEN システムは 各画材（watercolor/acrylic/colored-pencil）に応じた質感を適用する
6. WHEN 質感強度が指定されている場合 THEN システムは textureStrength（0-100、既定 40）を反映する
7. WHEN 生成処理が 30 秒以上かかる場合 THEN システムは タイムアウトエラーを表示し、フォールバック画像を提供する
8. WHEN 生成に失敗した場合 THEN システムは 元画像を参考画像として使用し、エラーメッセージを表示する

### 要件 6.5: カラーパレット表示・混色ガイド機能

**ユーザーストーリー:** 絵画学習者として、描画に使用する色のパレットと、その色を作るための混色方法を知りたい。そうすることで、実際の画材で正確な色を再現できる。

#### 受入基準

1. WHEN システムが画像を解析 THEN システムは 主要な 6-8 色を抽出してカラーパレットを生成する
2. WHEN カラーパレットを表示 THEN システムは 円形の美しいカラースウォッチとして各色を表示する
3. WHEN ユーザーが色をクリック THEN システムは その色の詳細情報（RGB 値、色名、混色レシピ）を表示する
4. WHEN 混色レシピを表示 THEN システムは 基本色（赤・青・黄・白・黒）からの混合比率と手順を説明する
5. WHEN 画材が選択されている場合 THEN システムは 選択画材に応じた具体的な色名と混色方法を提供する
6. WHEN 水彩画が選択されている場合 THEN システムは 透明水彩絵の具の特性（透明度・重ね塗り効果）を考慮した混色ガイドを表示する
7. WHEN アクリル絵の具が選択されている場合 THEN システムは 不透明絵の具の混色比率と乾燥後の色変化を説明する
8. WHEN 色鉛筆が選択されている場合 THEN システムは 重ね塗りによる色の作り方と圧力調整方法を説明する
9. WHEN 生成処理が 30 秒以上かかる場合 THEN システムは タイムアウトエラーを表示し、フォールバック画像を提供する
10. WHEN 生成に失敗した場合 THEN システムは 元画像を参考画像として使用し、エラーメッセージを表示する

### 要件 7: 参考画像表示機能

**ユーザーストーリー:** 絵画学習者として、各描画段階で参考となる画像を確認したい。そうすることで、目標とする仕上がりを視覚的に理解できる。

#### 受入基準

1. WHEN システムが参考画像を準備 THEN システムは 生成された画像または元画像を適切に表示する
2. WHEN 各ステップを表示 THEN システムは 対応する段階の参考画像を適切なサイズで表示する
3. WHEN 参考画像を表示 THEN システムは 画像の読み込み状態を適切に表示する
4. WHEN 参考画像のサイズが 1MB 以上 THEN システムは 画像を圧縮して表示速度を最適化する
5. WHEN 画像の表示でエラーが発生 THEN システムは 代替テキストまたはプレースホルダー画像を表示する

### 要件 8: レスポンシブデザイン対応

**ユーザーストーリー:** デスクトップユーザーとして、Chrome ブラウザで快適にアプリを使用したい。そうすることで、大画面で詳細な指導内容を確認できる。

#### 受入基準

1. WHEN ユーザーがデスクトップブラウザでアクセス THEN システムは デスクトップ最適化されたレイアウトを表示する
2. WHEN 画面幅が 1024px 以上 THEN システムは 参考画像とテキストを横並びで表示する
3. WHEN 画面幅が 768px 以下 THEN システムは 縦積みレイアウトに切り替える
4. WHEN ユーザーが Chrome ブラウザを使用 THEN システムは 全機能が正常に動作する
5. WHEN ページ読み込み時間が 3 秒以上 THEN システムは パフォーマンス警告を表示する

### 要件 9: エラーハンドリング・ユーザビリティ

**ユーザーストーリー:** アプリ利用者として、エラーが発生した場合に適切なフィードバックを受けたい。そうすることで、問題を理解し、適切な対処ができる。

#### 受入基準

1. WHEN API 呼び出しでエラーが発生 THEN システムは ユーザーフレンドリーなエラーメッセージを表示する
2. WHEN ネットワークエラーが発生 THEN システムは 「接続を確認してください」というメッセージと再試行ボタンを表示する
3. WHEN 画像処理でエラーが発生 THEN システムは 「画像を処理できませんでした」というメッセージを表示する
4. WHEN 長時間の処理中 THEN システムは 進捗インジケーターと推定残り時間を表示する
5. WHEN ユーザーが操作を中断 THEN システムは 確認ダイアログを表示し、データ損失を防ぐ

### 要件 10: パフォーマンス要件

**ユーザーストーリー:** アプリ利用者として、快適な速度でアプリを使用したい。そうすることで、学習に集中できる。

#### 受入基準

1. WHEN 画像アップロード処理 THEN システムは 10 秒以内に完了する
2. WHEN AI 解析処理 THEN システムは 30 秒以内に結果を表示する
3. WHEN 参考画像準備 THEN システムは 5 秒以内に画像の最適化を完了する
4. WHEN ページ遷移 THEN システムは 2 秒以内に新しいページを表示する
5. WHEN 同時ユーザー数が 100 人以上 THEN システムは 応答時間の劣化を 20%以内に抑制する

### 要件 11: カラーパレット・色混合解説機能

**ユーザーストーリー:** 絵画学習者として、色塗りの際に使用する色のパレットと、その色を作るための混色方法を知りたい。そうすることで、実際の画材で正確な色を再現できる。

#### 受入基準

1. WHEN システムが画像を解析 THEN システムは 主要な色（6-12 色）を抽出してカラーパレットを生成する
2. WHEN カラーパレットを表示 THEN システムは 各色の RGB 値・HSV 値・色名を表示する
3. WHEN ユーザーが特定の色をクリック THEN システムは その色の混色レシピ（基本色の組み合わせ）を表示する
4. WHEN 画材が選択されている場合 THEN システムは 選択画材に応じた混色方法を提供する
5. WHEN 混色解説を表示 THEN システムは 基本色の混合比率（例：「赤 70% + 黄 30%」）を具体的に示す
6. WHEN 複雑な色の場合 THEN システムは 段階的な混色手順（例：「まず赤と黄でオレンジを作り、そこに白を 10%加える」）を提供する
7. WHEN カラーパレットが生成できない場合 THEN システムは デフォルトの基本色パレットを表示する

### 要件 12: データセキュリティ・プライバシー

**ユーザーストーリー:** アプリ利用者として、アップロードした画像が適切に保護されることを確認したい。そうすることで、安心してサービスを利用できる。

#### 受入基準

1. WHEN ユーザーが画像をアップロード THEN システムは HTTPS 通信で画像を暗号化して送信する
2. WHEN 画像処理が完了 THEN システムは サーバー上の一時ファイルを自動削除する
3. WHEN ユーザーがセッションを終了 THEN システムは 関連する全ての一時データを削除する
4. WHEN 著作権保護された画像を検出 THEN システムは 利用規約違反として処理を停止する
5. IF ユーザーが明示的に保存を選択した場合のみ THEN システムは 暗号化してデータを保存する
